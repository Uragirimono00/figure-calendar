<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      width: 300px;
      padding: 16px;
      font-family: -apple-system, "Malgun Gothic", sans-serif;
      font-size: 13px;
      background: #1a1a2e;
      color: #e0e0e0;
    }
    h3 {
      font-size: 14px;
      margin-bottom: 12px;
      color: #fff;
    }
    .section {
      margin-bottom: 12px;
      padding: 10px;
      background: #16213e;
      border-radius: 6px;
    }
    .section-title {
      font-size: 12px;
      font-weight: bold;
      color: #aaa;
      margin-bottom: 8px;
    }
    .row {
      display: flex;
      gap: 8px;
      align-items: center;
    }
    .row + .row { margin-top: 6px; }
    .row label {
      font-size: 11px;
      color: #888;
      width: 55px;
      flex-shrink: 0;
    }
    select, input[type="text"] {
      flex: 1;
      padding: 4px 6px;
      border: 1px solid #333;
      border-radius: 4px;
      background: #1a1a2e;
      color: #e0e0e0;
      font-size: 12px;
    }
    input[type="text"]::placeholder { color: #555; }
    .cache-info {
      margin: 10px 0 8px;
      font-size: 11px;
      color: #888;
    }
    button {
      width: 100%;
      padding: 8px;
      border: none;
      border-radius: 4px;
      background: #e94560;
      color: #fff;
      font-size: 12px;
      cursor: pointer;
    }
    button:hover { background: #c73e54; }
    .btn-apply {
      background: #0f3460;
      margin-top: 8px;
    }
    .btn-apply:hover { background: #1a4a8a; }
    .btn-group { display: flex; gap: 6px; }
    .btn-group button { flex: 1; }
    .user-list {
      margin-top: 12px;
      max-height: 300px;
      overflow-y: auto;
      border-top: 1px solid #333;
    }
    .user-list::-webkit-scrollbar { width: 4px; }
    .user-list::-webkit-scrollbar-thumb { background: #444; border-radius: 2px; }
    .user-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 5px 0;
      border-bottom: 1px solid #222;
      font-size: 11px;
    }
    .user-row .name {
      color: #ccc;
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      margin-right: 6px;
    }
    .user-row .channel { color: #666; font-size: 9px; }
    .user-row .meta { text-align: right; white-space: nowrap; font-size: 10px; }
    .user-row .posts { font-weight: bold; }
    .posts-red { color: #ff6b6b; }
    .posts-green { color: #51cf66; }
    .user-row .time { color: #666; }
    .recheck-tag {
      color: #ff6b6b;
      font-size: 9px;
      font-weight: bold;
      border: 1px solid #ff6b6b44;
      border-radius: 3px;
      padding: 0 3px;
      margin-left: 4px;
    }
    .recheck-date {
      color: #666;
      font-size: 9px;
      margin-left: 4px;
    }
    .btn-refetch {
      background: none;
      border: 1px solid #555;
      color: #aaa;
      font-size: 9px;
      padding: 1px 5px;
      border-radius: 3px;
      cursor: pointer;
      width: auto;
      flex-shrink: 0;
      margin-left: 4px;
    }
    .btn-refetch:hover { border-color: #e94560; color: #e94560; background: none; }
    .btn-refetch.loading { color: #555; pointer-events: none; }
    .rate-limit-banner {
      background: rgba(233, 69, 96, 0.15);
      border: 1px solid #e9456044;
      border-radius: 6px;
      padding: 8px 10px;
      margin-bottom: 10px;
      font-size: 12px;
      color: #ff6b6b;
      text-align: center;
    }
    .btn-resume {
      width: auto;
      margin-top: 6px;
      padding: 4px 10px;
      font-size: 11px;
      background: #e94560;
    }
    .btn-resume:hover { background: #c73e54; }
    .list-controls {
      display: flex;
      gap: 6px;
      margin-bottom: 8px;
    }
    .list-controls input {
      flex: 1;
      min-width: 0;
    }
    .list-controls select {
      width: auto;
      flex-shrink: 0;
    }
    .btn-proxy-on { background: #51cf66; }
    .btn-proxy-on:hover { background: #40c057; }
  </style>
</head>
<body>
  <h3>작성자 정보 설정</h3>

  <div class="section">
    <div class="section-title">활성 채널</div>
    <div class="row">
      <input type="text" id="channels" placeholder="bishoujofigure, anime ...">
    </div>
    <div style="font-size:10px;color:#666;margin-top:4px;">쉼표로 구분. 비우면 전체 채널에서 동작</div>
  </div>

  <div class="section">
    <div class="section-title">기본</div>
    <div class="row">
      <label>조회 기간</label>
      <select id="default-months">
        <option value="1">1개월</option>
        <option value="2">2개월</option>
        <option value="3">3개월</option>
        <option value="6">6개월</option>
        <option value="12">1년</option>
        <option value="0">전체</option>
      </select>
    </div>
    <div class="row">
      <label>기준 글 수</label>
      <select id="default-threshold">
        <option value="3">3개 이하</option>
        <option value="5">5개 이하</option>
        <option value="10">10개 이하</option>
        <option value="20">20개 이하</option>
      </select>
    </div>
  </div>

  <div class="section">
    <div class="section-title">구매글 (category=buy)</div>
    <div class="row">
      <label>조회 기간</label>
      <select id="buy-months">
        <option value="1">1개월</option>
        <option value="2">2개월</option>
        <option value="3">3개월</option>
        <option value="6">6개월</option>
        <option value="12">1년</option>
        <option value="0">전체</option>
      </select>
    </div>
    <div class="row">
      <label>기준 글 수</label>
      <select id="buy-threshold">
        <option value="3">3개 이하</option>
        <option value="5">5개 이하</option>
        <option value="10">10개 이하</option>
        <option value="20">20개 이하</option>
      </select>
    </div>
  </div>

  <div class="section">
    <div class="section-title">판매글 (category=sell)</div>
    <div class="row">
      <label>조회 기간</label>
      <select id="sell-months">
        <option value="1">1개월</option>
        <option value="2">2개월</option>
        <option value="3">3개월</option>
        <option value="6">6개월</option>
        <option value="12">1년</option>
        <option value="0">전체</option>
      </select>
    </div>
    <div class="row">
      <label>기준 글 수</label>
      <select id="sell-threshold">
        <option value="3">3개 이하</option>
        <option value="5">5개 이하</option>
        <option value="10">10개 이하</option>
        <option value="20">20개 이하</option>
      </select>
    </div>
  </div>

  <button class="btn-apply" id="applySettings">조회 설정 적용</button>

  <div class="section">
    <div class="section-title">수집 간격</div>
    <div class="row">
      <label>대기 시간</label>
      <select id="fetchDelay">
        <option value="5">5초</option>
        <option value="10">10초</option>
        <option value="15">15초</option>
        <option value="20">20초</option>
        <option value="30">30초</option>
        <option value="45">45초</option>
        <option value="60">60초</option>
      </select>
    </div>
  </div>

  <div class="section">
    <div class="section-title">프록시 (IP 우회)</div>
    <div class="row" style="justify-content:space-between;">
      <span id="proxyStatus" style="font-size:11px;color:#888;">비활성</span>
      <button id="proxyToggle" style="width:auto;padding:4px 12px;font-size:11px;">활성화</button>
    </div>
    <div id="proxyInfo" style="display:none;margin-top:6px;">
      <div style="font-size:10px;color:#666;margin-bottom:4px;">
        현재: <span id="proxyCurrentIp">-</span> · 목록: <span id="proxyCount">0</span>개
      </div>
      <div class="btn-group">
        <button id="proxyRotate" style="font-size:10px;padding:4px;">다음 프록시</button>
        <button id="proxyRefresh" style="font-size:10px;padding:4px;">목록 새로고침</button>
      </div>
    </div>
  </div>

  <div id="rateLimitBanner" class="rate-limit-banner" style="display:none;">
    <span id="rateLimitText"></span>
    <button id="forceResume" class="btn-resume">제한 해제 &amp; 재수집</button>
  </div>
  <div class="cache-info" id="cacheInfo">저장된 유저: 0명</div>
  <div class="list-controls">
    <input type="text" id="searchInput" placeholder="닉네임 검색">
    <select id="filterSelect">
      <option value="all">전체</option>
      <option value="red">기준 미달</option>
      <option value="green">기준 초과</option>
      <option value="recheck">재조회 대상</option>
    </select>
  </div>
  <div class="user-list" id="userList"></div>

  <div class="section" style="margin-top:12px;">
    <div class="section-title">데이터 관리</div>
    <div class="btn-group">
      <button id="exportData">내보내기</button>
      <button id="importData">가져오기</button>
    </div>
    <input type="file" id="importFile" accept=".json" style="display:none;">
    <button id="clearCache" style="margin-top:6px;">캐시 초기화</button>
  </div>

  <script src="popup.js"></script>
</body>
</html>
